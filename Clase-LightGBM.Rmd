---
title: "Introducci√≥n a LightGBM con R"
author: "Carlos A. Torres Cubilla"
output:
  slidy_presentation: 
    number_sections: false
    toc: true
    toc_float:
      collapsed: false
      smooth_scroll: false
---

```{r setup, include=FALSE}
library(htmltools)
library(DiagrammeR)
knitr::opts_chunk$set(echo = TRUE, message = FALSE, warning = FALSE)
```

# ¬øQu√© es LightGBM?

LightGBM es un framework de *gradient boosting* que utiliza algoritmos de aprendizaje basados en √°rboles para crear modelos predictivos de manera eficiente y r√°pida. 

## ¬øQue significa LightGBM?

- üî¶ **Light** = ligero, r√°pido, optimizado
  - Se refiere a que es una versi√≥n optimizada del algoritmo de Gradient Boosting.
  - Est√° dise√±ado para consumir menos memoria y funcionar m√°s r√°pido que alternativas como XGBoost o Random Forests.
- üìà **GBM** = Gradient Boosting Machine
  - Un tipo de t√©cnica de ensemble learning que genera muchos modelos d√©biles (generalmente √°rboles de decisi√≥n) de forma secuencial, donde cada modelo aprende de los errores de sus predecesores para crear un modelo fuerte .
  - Se basa en usar el gradiente del error para mejorar paso a paso.

<div style="text-align: center;">
  <img src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiN2KPoea9rFZo4nb0SZKrBrEUjNv-xaqB7gF6Htl5lY5AtOmKH1yFalD9Y6XHNNgtUYqsJCPUr-7a4MJIvdcubXogxerrskVqKfQGhKSpUyrnroLhEi6P5vMXqYE22J3_dnLRuWiBv5Nw/s0/Random+Forest+03.gif" style="display: block; margin-left: auto; margin-right: auto;" width="75%"/>
</div>

<div class="gradient-boosting" style="background-color: #f9f9f9; border-left: 5px solid #007ACC; padding: 10px; margin-top: 0px;">
  LightGBM mejora los errores paso a paso combinando √°rboles de decisi√≥n peque√±os.
</div>

## ¬øQui√©n cre√≥ LightGBM?

<div style="display: flex; align-items: center; gap: 1rem;">
  <img src="https://upload.wikimedia.org/wikipedia/commons/4/44/Microsoft_logo.svg" 
       alt="Microsoft Logo" 
       style="height: 50px; margin-bottom: 0;" />

<div>
  <p style="margin: 0;">
    Desarrollado por <strong>Microsoft Research Asia</strong>  
    como parte del toolkit <strong>DMTK</strong> (Distributed Machine Learning Toolkit).
  </p>
  <p style="margin: 0;">
    Lanzado en <strong>2016</strong> como proyecto <em>open source</em>.
  </p>
</div>
</div>

> <em>"Creamos LightGBM para resolver problemas del mundo real a gran escala con eficiencia."</em>  
> ‚Äî <strong>Microsoft DMTK Team</strong>


# ¬øPor qu√© utilizar LightGBM?

LightGBM se destaca no solo por su rendimiento predictivo, sino tambi√©n por su eficiencia computacional. Su adopci√≥n generalizada en aplicaciones reales de machine learning se puede explicar mediante cinco ventajas clave.

```{r ventajas, echo=FALSE}
ventajas_style <- "
  display: flex; 
  flex-direction: column; 
  align-items: center; 
  width: 120px; 
  transition: transform 0.3s;
"

tags$div(
  style = "display: flex; justify-content: center; gap: 40px; margin-top: 20px;",

  tags$div(
    style = ventajas_style,
    onmouseover = sprintf("this.style.transform='scale(1.1)'"),
    onmouseout = sprintf("this.style.transform='scale(1)'"),
    tags$span(style = "font-size: 40px;", "‚ö°"),
    tags$p("Velocidad")
  ),

  tags$div(
    style = ventajas_style,
    onmouseover = sprintf("this.style.transform='scale(1.1)'"),
    onmouseout = sprintf("this.style.transform='scale(1)'"),
    tags$span(style = "font-size: 40px;", "üíæ"),
    tags$p("Memoria")
  ),

  tags$div(
    style = ventajas_style,
    onmouseover = sprintf("this.style.transform='scale(1.1)'"),
    onmouseout = sprintf("this.style.transform='scale(1)'"),
    tags$span(style = "font-size: 40px;", "üéØ"),
    tags$p("Precisi√≥n")
  ),

  tags$div(
    style = "display: flex; flex-direction: column; align-items: center; width: 120px; transition: transform 0.3s;",
    onmouseover = sprintf("this.style.transform='scale(1.1)'"),
    onmouseout = sprintf("this.style.transform='scale(1)'"),
    tags$span(style = "font-size: 40px;", "üñ•Ô∏è"),
    tags$p("Paralelismo")
  ),

  tags$div(
    style = ventajas_style,
    onmouseover = sprintf("this.style.transform='scale(1.1)'"),
    onmouseout = sprintf("this.style.transform='scale(1)'"),
    tags$span(style = "font-size: 40px;", "üìä"),
    tags$p("Escalabilidad")
  )
)
```

<div style="margin: 0 auto; width: fit-content;">
| Ventaja       | Descripci√≥n                                                                 |
|---------------|------------------------------------------------------------------------------|
| Velocidad   | Entrena modelos r√°pidamente, lo que lo hace ideal para proyectos con grandes vol√∫menes de datos. |
| Memoria     | Optimiza el consumo de memoria, permitiendo trabajar con datasets grandes sin requerir tanta RAM.         |
| Precisi√≥n   | Proporciona resultados precisos y competitivos en tareas de predicci√≥n.                    |
|  Paralelismo | Aprovecha m√∫ltiples n√∫cleos, cl√∫steres y aceleraci√≥n por GPU para entrenamientos m√°s r√°pidos.            |
| Escalabilidad | Maneja grandes vol√∫menes de datos sin p√©rdida de rendimiento.       |
</div>

## Uso

LightGBM es  altamente vers√°til que permite resolver una amplia variedad de problemas, desde tareas tradicionales como clasificaci√≥n y regresi√≥n, hasta aplicaciones m√°s complejas como ranking, detecci√≥n de fraude y sistemas de recomendaci√≥n personalizados. Esto lo convierte en una herramienta poderosa y escalable para proyectos de aprendizaje autom√°tico en entornos reales.

```{r uso, echo=FALSE}
browsable(
  tags$div(
    style = "
      display: flex;
      justify-content: center;
      align-items: center;
      background: transparent;
    ",
    tags$style(HTML("
      /* Reset total de margenes/paddings en Slidy */
      body, html, .slide, .content {
        margin: 0 !important;
        padding: 0 !important;
        height: 0% !important;
      }

      /* El SVG generado por DiagrammeR */
      svg {
        display: block;
        margin: 0;
        padding: 0;
        height: auto;
        width: 0;
        max-height: 30vh;
      }

      .grViz {
        display: flex;
        justify-content: center;
        align-items: center;
        padding: 0 !important;
        margin: 0 !important;
        height: auto;
        width: 0;
        max-height: 30vh;
      }
      }
    ")),
    grViz("
      digraph lightgbm {
        graph [rankdir = TB, margin=0, nodesep=0.3, ranksep=0.3]
        node [shape = box, style = filled, fillcolor = LightGray, fontsize = 12, margin=0.05]

        Usos [label = '¬øPara qu√© se usa?', shape=box, fillcolor=lightblue]
        Clasificacion [label = 'Clasificaci√≥n']
        Regresion [label = 'Regresi√≥n']
        Ranking [label = 'Ranking']
        DeteccionFraude [label = 'Detecci√≥n de\\nfraude']
        Recomendacion [label = 'Sistemas de\\nrecomendaci√≥n']

        Usos -> Clasificacion
        Usos -> Regresion
        Usos -> Ranking
        Usos -> DeteccionFraude
        Usos -> Recomendacion
      }
    ")
  )
)
```

Much√≠simas empresas en todo el mundo utilizan LightGBM debido a su velocidad y precisi√≥n para resolver distintos problemas de machine learning. Algunos ejemplos de compa√±√≠as l√≠deres que han implementado LightGBM en sus soluciones para estos casos de uso:

```{r empresas, echo=FALSE}
html <- tags$div(
  # Estilo del contenedor general
  style = "display: flex; justify-content: center; flex-wrap: wrap; gap: 40px; margin-top: 20px;",
  
  # Estilo para flip cards
  tags$style(HTML("
    .flip-card {
      background-color: transparent;
      width: 175px;
      height: 250px;
      perspective: 1000px;
    }

    .flip-card-inner {
      position: relative;
      width: 100%;
      height: 100%;
      transform-style: preserve-3d;
      transition: transform 0.6s ease;
      transform-origin: center center;
    }

    .flip-card:hover .flip-card-inner {
      transform: rotateY(180deg);
    }

    .flip-card-front, .flip-card-back {
      position: absolute;
      width: 100%;
      height: 100%;
      backface-visibility: hidden;
      border-radius: 10px;
      box-shadow: 0 4px 8px rgba(0,0,0,0.1);
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      padding: 10px;
      box-sizing: border-box;
      text-align: center;
      overflow: hidden;
    }

    .flip-card-front {
      background: white;
    }

    .flip-card-back {
      background-color: #f0f0f0;
      transform: rotateY(180deg);
      font-size: 0.75em;
    }

    .flip-card img {
      width: 90px;
      height: auto;
      margin-bottom: 10px;
    }
    
  ")),

  # Contenido de las tarjetas
  lapply(list(
    list(nombre = "Microsoft", uso = "Clasificaci√≥n", logo = "https://upload.wikimedia.org/wikipedia/commons/9/96/Microsoft_logo_%282012%29.svg", detalle = "Categorizar correos y detectar spam"),
    list(nombre = "Uber", uso = "Regresi√≥n", logo = "https://upload.wikimedia.org/wikipedia/commons/5/58/Uber_logo_2018.svg", detalle = "Estimar demanda y tiempos de llegada"),
    list(nombre = "LinkedIn", uso = "Ranking", logo = "https://upload.wikimedia.org/wikipedia/commons/a/aa/LinkedIn_2021.svg", detalle = "Ordenar resultados de b√∫squeda y recomendaciones de empleo"),
    list(nombre = "PayPal", uso = "Detecci√≥n de fraude", logo = "https://upload.wikimedia.org/wikipedia/commons/b/b5/PayPal.svg", detalle = "Detectar transacciones sospechosas en tiempo real"),
    list(nombre = "Netflix", uso = "Sistemas de recomendaci√≥n", logo = "https://upload.wikimedia.org/wikipedia/commons/0/08/Netflix_2015_logo.svg", detalle = "Personalizar sugerencias de contenido")
  ), function(e) {
    tags$div(class = "flip-card",
      tags$div(class = "flip-card-inner",
        tags$div(class = "flip-card-front",
          tags$img(src = e$logo),
          tags$p(e$uso, style = "color: gray; font-size: 0.85em;")
        ),
        tags$div(class = "flip-card-back",
          tags$strong(e$nombre),
          tags$p(e$detalle)
        )
      )
    )
  })
)

browsable(html)
```

# Instalaci√≥n

```{r instalacion}
# Instalar solo si no est√°n instalados
# install.packages("lightgbm", repos = "https://cran.r-project.org")
# install.packages("Matrix")
# install.packages("data.table")

library(lightgbm)
library(Matrix)
library(data.table)

```